\section{Measure (TBD)}

  The introduction of the $\sigma$-algebra seemed quite arbitrary, but bear with me as it will make sense very soon. In general, we want to define a measure $\mu: 2^X \to [0, +\infty]$ that satisfies two properties. 
  \begin{enumerate}
    \item \textit{Null empty set}. $\mu(\emptyset) = 0$. 
    \item \textit{Countable Additivity}. For all countable collections $\{A_k\}_{k=1}^\infty$ of pairwise disjoint subsets $A_k \subset 2^{X}$, 
    \begin{equation}
      \mu \bigg( \bigsqcup_{k=1}^\infty A_k \bigg) = \sum_{k=1}^\infty \mu(A_k)
    \end{equation}
  \end{enumerate} 

  The first condition is important because it allows us to take finite disjoint unions. That is, since $\mu(A_1 \cup A_2) = \mu(A_1 \cup A_2 \cup \emptyset \cup \ldots)$, we have 
  \begin{equation}
    \sum_{k=1}^\infty = \mu(A_1) + \mu(A_2)
  \end{equation}
  Disjointness is clearly important since if it wasn't, then $\mu(A) = \mu(A \cup A) = 2 \mu(A)$, which is absurd. 

  It turns out that this second property is highly restrictive, and in fact some measures cannot be even defined---in the sense that we can create partitions of weird sets and rearrange them to get paradoxes (the most famous being the Banach-Tarski paradox). Therefore, we need to find a certain subset $\mathcal{A} \subset 2^X$ that is consistent with this definition of measure. 
  
  \begin{enumerate}
    \item We want to define a function $\mu^\ast: 2^X \to [0, +\infty]$ that has a slightly less restrictive form of property 2.\footnote{How we implement such a function is a different question, though.} We should always be able to construct such a function, which we will call the \textit{outer measure}. 

    \item Then, we want to use this outer measure to define sets that should like in $\mathcal{A}$. We call these \textit{measurable sets}. It will turn out that $\mathcal{A}$ must be a $\sigma$-algebra. 

    \item Finally, we take the restriction of the outer measure to only measurable sets, and this defines our measure: $\mu = \mu^\ast \big|_{\mathcal{A}}$.  
  \end{enumerate}

  \footnote{Old but good explanation: Now let's try to construct a measure $\lambda$ on the Borel $\sigma$-algebra $\mathcal{B}(\mathbb{R})$ that assigns length, i.e. $\lambda([a, b]) = b - a$. We will do so by constructing outer measures $\lambda^*: 2^\mathbb{R} \longrightarrow \mathbb{R}$ that acts on the power set of $\mathbb{R}$ s.t. $\lambda^*([a, b]) = b - a$. But this turns out to have its own problems and contradictions, so once we construct such a $\lambda^*$, we will "throw away" all the sets that don't behave nicely under $\lambda^*$ and just use its restriction on the Borel algebra. It turns out that the sets that do behave well under $\lambda^*$ is bigger than the Borel algebra, call it $\mathcal{M}_{\lambda^*}$. So, we have $\mathcal{B}(\mathbb{R}) \subset \mathcal{M}_{\lambda^*} \subset 2^\mathbb{R}$. We will do this in full generality in the following way. We take any space $X$ and construct an outer measure $\mu^*$ on its power set $2^X$. Then, we construct the $\sigma$-algebra of well-behaved sets $\mathcal{M}_{\mu^*} \subset 2^X$, and define our measure $\mu$ on $\mathcal{M}_{\mu^*}$. When defining our outer measure, the condition that the outer measure of a disjoint union of subsets is equal to the sum of the outer measure of the subsets is a bit too restricting, so we use a softer condition. }

  \begin{definition}[Measure]
    Given a measurable space $(X, \mathcal{A})$, a \textbf{measure} is a function $\mu : \mathcal{A} \longrightarrow [0, +\infty]$\footnote{We usually introduce this by taking the codomain to be either $[0, +\infty]$ or $(-\infty, +\infty)$, which is the signed measure.} satisfying 
    \begin{enumerate}
      \item Null empty set $\mu(\emptyset) = 0$. 
      \item Countable additivity: 
        For all countable collections $\{A_k\}_{k=1}^\infty$ of pairwise disjoint subsets $A_k \in \mathcal{A}$, 
      \begin{equation}
        \mu \bigg( \bigsqcup_{k=1}^\infty A_k \bigg) = \sum_{k=1}^\infty \mu(A_k)
      \end{equation}
      Remember that we are allowed to take countable unions inside our $\sigma$-algebra, so this makes sense. 
    \end{enumerate}
    This immediately implies that given $A, B \in \mathcal{A}$, then $A \subset B \implies \mu(A) \leq \mu(B)$. The triplet $(X, \mathcal{A}, \mu)$ is called a \textbf{measure space}. 
  \end{definition}

  Let's go through each of these three steps in detail. 

\subsection{Outer Measure} 

  \begin{definition}[Outer Measure]
    Given a space $X$, an \textbf{outer measure} is a function $\mu^\ast : 2^X \to [0, +\infty]$ satisfying either the two properties. 
    \begin{enumerate}
      \item \textit{Null Empty Set}. $\mu^\ast(\emptyset) = 0$. 
      \item \textit{Countable Subadditivity}. For arbitrary subset $A, B_1, B_2, \ldots$, 
      \begin{equation}
        A \subset \bigcup_{k=1}^\infty B_k \implies \mu(A) \leq \sum_{k=1}^\infty \mu(B_k)
      \end{equation} 
    \end{enumerate}

    or equivalently, the three properties. 
    \begin{enumerate}
      \item \textit{Null Empty Set}. $\mu^\ast(\emptyset) = 0$. 
      \item \textit{Monotonicity}. If $A, B \subset X$, then 
      \begin{equation}
        A \subset B \implies \mu^\ast (A) \leq \mu^\ast (B)
      \end{equation}
      \item \textit{Countable Subadditivity}. For any countable collection of subsets $\{A_k\}$ of $X$, 
      \begin{equation}
        \mu^\ast \bigg( \bigcup_k A_k \bigg) \leq \sum_{k} \mu^\ast (A_k) 
      \end{equation}
    \end{enumerate}
  \end{definition}
  \begin{proof}
    Prove that the two definitions are equal. 
  \end{proof} 

  It's a hard definition, but a natural one, since we're taking all these intervals and trying to make them as snug as possible to define the outer measure of an arbitrary set. As always, let's begin with the simplest case in the real line. The following definition suffices. 

  \begin{lemma}[Lebesgue Outer Measure is an Outer Measure]
    The Lebesgue outer measure $\lambda^\ast$ on $\mathbb{R}$ is indeed an outer measure. 
  \end{lemma} 

  We can also generalize this further by introducing a increasing, continuous function $F: \mathbb{R} \rightarrow \mathbb{R}$ and defining the outer measure to be 
  \begin{equation}
   \lambda^\ast (A) = \inf_{C_A} \sum_{j=1}^\infty \big( F(b_j) - F(a_j) \big) 
  \end{equation}

\subsection{Measurable Sets} 

  \begin{definition}[Carath√©odory's criterion]
    Given outer measure $\mu^\ast$ on $X$, a set $E \subset X$  is called \textbf{$\mu^\ast$-measurable} if for every set $A \subset X$, 
    \begin{equation}
      \mu^\ast (A \cap E) + \mu^\ast (A \cap E^c) = m^\ast (A) 
    \end{equation}
  \end{definition} 

  In general it says that no matter how nasty a subset $A$ is, $E$ should be nice enough that we can cut $E$ into two pieces $C$ and $D$. Due to the definition of the outer measure, we are guaranteed to have  $\mu^\ast (C \cup D) \leq \mu^\ast (C) + \mu^\ast (D)$. The sets with which this inequality is strict is not measurable, and the measurable sets specifically satisfy 
  \begin{enumerate}
    \item equality 
    \item for countable sets. 
  \end{enumerate}

  One should note that in particular, if $E$ is $\mu^\ast$-measurable and $A$ is any set disjoint from $E$, then we must have 
  \begin{align}
    \mu^\ast (A \cup E) & = \mu^\ast ((A \cup E) \cap E) + \mu^\ast ((A \cup E) \cap E^c) \\ 
                        & = \mu^\ast (E) + \mu^\ast (A)
  \end{align}
  which solves a bit of the theorem on measures. In practice, we will often prove that $\mu^\ast (A \cap E) + \mu^\ast (A \cap E^c) \leq m^\ast (A)$, since the properties of outer measure implies $\geq$. 

  \begin{example}
    Take $X = \mathbb{R}$ and have $B = (-\infty, b]$. Then $B^c = (b, \infty)$, and $B$ divides $\mathbb{R}$ into a right side and a left side. If we take any subset $A \subset \mathbb{R}$, then $B$ is nice enough to divide $A$ into a left and a right side. 
  \end{example} 

  Now we want to establish some nice properties. 

  \begin{theorem}[Outer Measure $0$ Sets are Measurable]
    For any outer measure $\mu^\ast$ on $X$, $E \subset X$ with $\mu^\ast (E) = 0$  implies that $E$ is $\mu^\ast$-measurable. 
  \end{theorem}
  \begin{proof}
    Take any $A$. Then $(A \cap E) \subset E$ and $(A \cap E^c) \subset A$. So by monotonicity, 
    \begin{equation}
      \mu^\ast(A \cap E) + \mu^\ast (A \cap E^c) \leq \mu^\ast(E) + \mu^\ast(A) = \mu^\ast (A)
    \end{equation}
    and this by definition means that $E$ is measurable. 
  \end{proof}

  Now let's talk about constructing measurable sets. 

  \begin{theorem}[Finite Unions are Measurable]
    A finite union of $\mu^\ast$-measurable sets is $\mu^\ast$-measurable. 
  \end{theorem}
  \begin{proof}
    It suffices to prove for $E_1, E_2$, and the rest follows by induction. Fix any $A$. Then 
    \begin{align}
      \mu^\ast (A) & = \mu^\ast (A \cap E_1) + \mu^\ast (A \cap E_1^c) \\ 
                   & = \mu^\ast (A \cap E_1) + \mu^\ast \big((A \cap E_1^c) \cap E_2 \big) + \mu^\ast \big((A \cap E_1^c) \cap E_2^c \big)
    \end{align}
    But 
    \begin{align}
      (A \cap E_1^c) \cap E_2^c & = A \cap (E_1 \cup E_2)^c \\ 
      (A \cap E_1^c) \cap E_2 & = (A \setminus E_1) \setminus E_2 
    \end{align}
    So, $(A \cap E_1) \cup \big( (A \setminus E_1) \cap E_2 \big) = A \cap \big(A \cap (E_1 \cup E_2)^c \big)$. Therefore, we get 
    \begin{equation}
      \mu^\ast (A \cap E_1) + \mu^\ast \big((A \cap E_1^c) \cap E_2 \big) + \mu^\ast \big((A \cap E_1^c) \cap E_2^c \big) \geq \mu^\ast (A \cap (E_1 \cup E_2)) + \mu^\ast ( A \cap (E_1 \cup E_2)^c ) 
    \end{equation}
  \end{proof} 

  So we have proved that the set of all measurable sets is closed under finite unions. By definition it works for finite intersections. This makes it into an \textit{algebra}, but we want to upgrade this to a $\sigma$-algebra by proving closure under \textit{countable} unions. We will need the lemma. 

  \begin{lemma} 
    Suppose $E_1, \ldots, E_n$ are disjoint. Then, 
    \begin{equation}
      \mu^\ast \bigg( \bigcup_{j=1}^n E_j \bigg) = \sum_{j=1}^n \mu^\ast (E_j)
    \end{equation}
  \end{lemma}
  \begin{proof}
    We already did this for 2 sets, and just use induction. 
  \end{proof} 

  Now we prove lemma, which is more general (arbitrary intersections than finite?). 

  \begin{lemma} 
    Suppose $A$ is any set, $E_j$ disjoint and measurable. Then, 
    \begin{equation}
      \mu^\ast \bigg( A \cap \Big( \bigcup_{j=1}^n E_j \Big) \bigg) = \sum_{j=1}^n \mu^\ast (A \cap E_j)
    \end{equation}
  \end{lemma}
  \begin{proof}
    By induction, $n = 1$ is true. Then, 
    \begin{align}
      \mu^\ast \bigg( A \cap \Big( \bigcup_{j=1}^n E_j \Big) \bigg) 
        & = \mu^\ast \Bigg( \bigg( A \cap \Big( \bigcup_{j=1}^n E_j \Big) \bigg) \cap E_n \Bigg) + \mu^\ast \Bigg( \bigg( A \cap \Big( \bigcup_{j=1}^n E_j \Big) \bigg) \cap E_n^c \Bigg) \\  
        & = \mu^\ast (A \cap E_n) + \mu^\ast \bigg( A \cap \Big( \bigcup_{j=1}^{n-1} E_j \Big) \bigg) \\ 
        & = \sum_{j=1}^n \mu^\ast (A \cap E_j)
    \end{align}
    by the induction hypothesis. 
  \end{proof}

  \begin{theorem}[Countable Unions are Outer Measurable]
    Suppose $E_1, E_2, \ldots$ are a countable collection of measurable sets. Then, $E = \cup_{j=1}^\infty E_j$ is measurable. 
  \end{theorem}
  \begin{proof}
    They key is to look at disjoint sets. WLOG, one can assume $E_j$ are disjoint. Indeed, we can define new sets 
    \begin{equation}
      E_n^\prime \coloneqq E_n \setminus \bigg( \bigcup_{j=1}^{n-1} E_j \bigg) 
    \end{equation}
    that are measurable, with $\cup E_n^\prime = \cup E_n$. Now, fix any set $A$. Define sets $F_n = \cup_{j=1}^n E_j$. Then, $\mu^\ast (A) = \mu^\ast (A \cap F_n) + \mu^\ast (A \cap F_n^c)$. Then, $F_n^c \supset E^c \implies \mu^\ast (A \cap F_n^c) \geq \mu^\ast (A \cap E^c)$. Through the previous lemma, we have 
    \begin{equation}
      \mu^\ast (A \cap F_n) = \mu^\ast \bigg( \bigcup_{j=1}^n (A \cap E_j) \bigg) = \sum_{j=1}^n \mu^\ast (A \cap E_j) 
    \end{equation}
    Then, 
    \begin{equation}
      \mu^\ast (A) \geq \sum_{j=1}^n \mu^\ast (A \cap E_j) + \mu^\ast (A \cap E^c) 
    \end{equation}
    for every $n$, therefore also with $\infty$. But 
    \begin{equation}
      \sum_{j=1}^\infty \mu^\ast (A \cap E_j) \geq \mu^\ast (A \cap E)
    \end{equation}
    If follows that $\mu^\ast (A) \geq \mu^\ast (A \cap E) + \mu^\ast (A \cap E^c)$. 
  \end{proof}

  \begin{corollary}[Measurable Sets form a $\sigma$-Algebra]
    The set of all $\mu^\ast$-measurable sets of $X$ form a $\sigma$-algebra. 
  \end{corollary}

  With this, we can construct a lot of measurable sets. 

  \begin{lemma}[Sets of Measure 0 have no Effect]
    Suppose $\mu^\ast (E) = 0$ and $A$ is any set. Then, $\mu^\ast (A \cup E) = \mu^\ast (A)$. 
  \end{lemma}
  \begin{proof}
    We have 
    \begin{equation}
      \mu^\ast (A \cup E) = \underbrace{\mu^\ast \big( (A \cup E) \cap E \big)}_{=0} + \mu^\ast \underbrace{\big( (A \cup E) \cap E^c \big)}_{\subset A} \leq \mu^\ast (A) \leq \mu^\ast (A)
    \end{equation}
    But $A \cup E \supset A$, so $\mu^\ast (A \cup E) = \mu^\ast (A)$. 
  \end{proof}

  So we can always drop an outer-measure $0$ set and it won't affect the outer measure of the original set. 

  \begin{theorem}
    Every interval $(a, +\infty)$ is measurable. 
  \end{theorem}
  \begin{proof}
    Take any set $A$, and WLOG $a \not\in A$ (since we can take the point out without affecting outer measure). Suppose $\{I_k\}_{k=1}^\infty$ is a cover of $A$ s.t. 
    \begin{equation}
      \mu^\ast > \bigg( \sum_{k=1}^\infty \ell (I_k) \bigg) - \epsilon 
    \end{equation}
    Then, 
    \begin{enumerate}
      \item $I_k^\prime \coloneqq I_k \cap (a, +\infty)$ will cover $A_1 = A \cap (a, +\infty)$, and 
      \item $I_k^{\prime\prime} \coloneqq I_k \cap (-\infty, a)$ will cover $A_2 = A \cap (-\infty, a)$. 
    \end{enumerate}
    Therefore, $\mu^\ast (A_1)  \leq \sum_k \ell(I_k^\prime)$, $\mu^\ast (A_2) \leq \sum_k \ell(I_k^{\prime\prime})$. Also, 
    \begin{equation}
      \ell(I_k) = \ell(I_k^\prime) + \ell(I_k^{\prime\prime}) \implies \mu^\ast (A_1) + \mu^\ast (A_2) \leq \sum_k \ell(I_k) \leq \mu^\ast (A) + \epsilon
    \end{equation}
    for every $\epsilon > 0$. Since this is true for every $\epsilon > 0$, we are done.  
  \end{proof}
  
  The next theorem shows that we can construct measurable sets with ``nice'' sets on the real line. 

  \begin{theorem}[$\lambda^\ast$-measurable Sets]
    TFAE in $\mathbb{R}$ with the Lebesgue outer measure. 
    \begin{enumerate}
      \item $E$ is measurable. 
      \item $\forall \epsilon > 0$, $\exists$ open set $O \supset E$  s.t. $\mu(O \setminus E) \leq \epsilon$. 
      \item $\forall \epsilon > 0$, $\exists$ closed set $F \subset E$ s.t. $\mu^\ast (E \setminus F) < \epsilon$. 
      \item $\exists$ a $G_\delta$ set $G$ s.t. $E \subset G$ and $\mu^\ast (G \setminus E) = 0$. 
      \item $\exists$ a $F_\sigma$ set $F$ s.t. $F \subset E$ and $\mu^\ast (E \setminus F) = 0$. 
    \end{enumerate}
  \end{theorem}
  \begin{proof}
    Listed. 
    \begin{enumerate}
      \item (2) $\implies$ (1). Then for every $k \in \mathbb{N}$, we can find $O_k \supset E$ s.t. $m^\ast (O_k \setminus E) \leq 1/k$. Define the $G_\delta$ set $G = \cap_{k=1}^\infty O_k$. Then, $(G \setminus E) \subset (O_k \setminus E)$ for all $k \implies m^\ast (G \setminus E) \leq 1/k$ for all $k$. Therefore $m^\ast (G \setminus E) = 0$, and $E = G \setminus (G \setminus E)$ is measurable. 

      \item (1) $\implies$ (2). Assume $m^\ast (E) < +\infty$. Find a cover $\{I_k \}_{k=1}^\infty$ s.t. $\sum_{k=1}^\infty \ell (I_k) \leq m^\ast (E) + \epsilon$ . Call $O = \cup_k I_k$. Since $E$ is measurable, $m^\ast (O \setminus E) = m^\ast (O) - m^\ast (E) \leq \sum_{k=1}^\infty \ell(I_k) - m^\ast (E) \leq \epsilon$ 

      \item (1) $\iff$ (3). Straightforward with argument above.  

      \item (1) $\iff$ (4). Generally, we use the fact that $E$ measurable iff $E^c$ measurable. Find $O \supset E^c$ open, with $m^\ast (O \setminus E^c) \leq \epsilon$. Then $F = O^c$ is closed, $F \subset E$, and $m^\ast (E \setminus F) \leq \epsilon$. 

      \item (1) $\iff$ (5). Same argument as (1) $\iff$ (4). 
    \end{enumerate}
  \end{proof}

  The following theorem is a major one, showing that measurable sets can be approximated well by Borel sets. 

  \begin{theorem}[]
    Suppose $E$ is measurable, with $m^\ast (E) < +\infty$. Fix $\epsilon > 0$. Then there exists a finite number of intervals $\{I_k\}_{k=1}^n$ s.t. if $O = \cup_{ k=1}^n I_k$, then 
    \begin{equation}
      m^\ast (O \setminus E) + m^\ast (E \setminus O) < \epsilon
    \end{equation}
  \end{theorem}
  \begin{proof}
    Find $\{I_k\}_{k=1}^\infty$ s.t. $U = \cup_{k=1}^\infty I_k$ satisfies $E \subset U$, $m^\ast (U \setminus E) \leq \epsilon/2$. Find $n$ s.t. $\sum_{k=n+1}^\infty \ell(I_k) \leq \epsilon/2$ where WLOG, $I_k$ are disjoint. Define $O = \cup_{k=1}^n I_k$. Then, we have 
    \begin{align}
      m^\ast (O \setminus E) & \leq m(U \setminus E) \leq \frac{\epsilon}{2} \\ 
      m^\ast (E \setminus O) & \leq m(U \setminus O) \leq \sum_{k=n+1}^\infty \ell(I_k) \leq \frac{\epsilon}{2}
    \end{align}
  \end{proof}

  For $\mathbb{R}$, we can create our Lebesgue outer measure $\lambda^*$ on it, which generates the Lebesgue $\sigma$-algebra $\mathcal{M}_{\lambda^*}$. This turns out to be bigger than the Borel $\sigma$-algebra $\mathcal{B}(\mathbb{R})$, but there is little difference in which one we choose when we actually integrate. 

  \begin{theorem}
    A set $E \subset \mathbb{R}$ is Lebesgue measurable implies that it is also Borel measurable. 
    \begin{equation}
      \mathcal{B}(\mathbb{R}) \subset \mathcal{M}_{\lambda^*} \subset 2^\mathbb{R}
    \end{equation}
  \end{theorem}

  \begin{lemma}
    If $E \subset \mathbb{R}$ and $\lambda^*(E) = 0$, then $E \in \mathcal{M}_{\lambda^*}$, i.e. $E$ is Lebesgue outer-measurable. 
  \end{lemma}
  \begin{proof}
    We must prove that $E$ satisfies the Carath√©odory's criterion. For all $E \subset \mathbb{R}$, we know that $\lambda^*(A) \leq \lambda^*(A \cap E) + \lambda^*(A \cap E^c)$ by definition of outer measure. Now, since $\lambda^* (E) =0$ and $A \cap E \subset E$, this means that $\lambda^* (A \cap E) = 0$ also. Furthermore, $A \cap E^c \subset A$, meaning that $\lambda^*(A) \geq \lambda^* (A \cap E^c)$, and we get 
    \begin{equation}
      \lambda^*(A) \geq \lambda^*(A \cap E) + \lambda^*(A \cap E^c)
    \end{equation}
    which proves equality. 
  \end{proof}

